{"version":3,"sources":["jsParser-Spec.js"],"names":[],"mappings":"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","file":"jsParser-Spec-compiled.js","sourcesContent":["/**\n * The MIT License (MIT)\n * Copyright (c) 2015 AceMood\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n * @file jsParser对于代码匹配的功能\n * @author AceMood\n */\n\n/* globals describe */\n/* globals it */\n\ndescribe('jsParser', function() {\n\n  var expect = require('chai').expect;\n  var extract = require('./parser/jsparser');\n\n  describe('require', function() {\n    it('should extract normal requires', function() {\n      var code =\n        'var a = require(\"foo\");\\n' +\n        'var b = require(\"bar\");\\n';\n\n      var ret = extract.requireCalls(code);\n\n      expect(ret).to.be.a('array');\n      expect(ret).to.have.length(2);\n      expect(ret).to.deep.equal(['foo', 'bar']);\n    });\n\n\n    it('should not extract from comments', function() {\n      var code =\n        '/* a = require(\"b\") */\\n' +\n        'var a = require(\"foo\");\\n' +\n        '// var a = require(\"yada\");\\n' +\n        'var b = require(\"bar\");\\n';\n\n      var ret = extract.requireCalls(code);\n\n      expect(ret).to.be.a('array');\n      expect(ret).to.have.length(2);\n      expect(ret).to.deep.equal(['foo', 'bar']);\n    });\n\n\n    it('should extract require at the start', function() {\n      var code =\n        'require(\"foo\");\\n' +\n        'var b = require(\"bar\");\\n';\n\n      var ret = extract.requireCalls(code);\n\n      expect(ret).to.be.a('array');\n      expect(ret).to.have.length(2);\n      expect(ret).to.deep.equal(['foo', 'bar']);\n    });\n\n\n    it('should ignore non require', function() {\n      var code =\n        'require(\"foo\");\\n' +\n        'foo.require(\"something\");\\n' +\n        'foo_require(\"something_new\");\\n' +\n        'var b = [require(\"bar\")];\\n';\n\n      var ret = extract.requireCalls(code);\n\n      expect(ret).to.be.a('array');\n      expect(ret).to.have.length(2);\n      expect(ret).to.deep.equal(['foo', 'bar']);\n    });\n\n\n    it('should dedupe matches', function() {\n      var code =\n        'require(\"foo\");\\n' +\n        'var b = require(\"foo\");\\n';\n\n      var ret = extract.requireCalls(code);\n\n      expect(ret).to.be.a('array');\n      expect(ret).to.have.length(1);\n      expect(ret).to.deep.equal(['foo']);\n    });\n  });\n\n  describe('requireDotAsync', function() {\n    it('should extract simplest case', function() {\n      var code =\n        'require.async([\"foo\", \\'bar\\'], function() {\\n' +\n        '  return 2 + 2;\\n';\n        '});\\n';\n\n      var ret = extract.requireAsyncCalls(code);\n\n      expect(ret).to.be.a('array');\n      expect(ret).to.have.length(2);\n      expect(ret).to.deep.equal(['foo', 'bar']);\n    });\n\n    it('should ignore invalid cases', function() {\n      var code =\n        'foo.require.async([\"foo\", \\'bar\\'], function() {\\n' +\n        '  return 2 + 2;\\n' +\n        '});\\n';\n\n      var ret = extract.requireAsyncCalls(code);\n\n      expect(ret).to.be.a('array');\n      expect(ret).to.have.length(0);\n      expect(ret).to.deep.equal([]);\n    });\n\n    it('should dedup', function() {\n      var code =\n        'require.async([\"foo\", \\'bar\\'], function(f, b) {\\n' +\n        '  require.async([\"foo\", \"baz\"], function(f, b) {\\n' +\n        '    alert(1);\\n' +\n        '  };\\n' +\n        '  return 2 + 2;\\n' +\n        '});\\n';\n\n      var ret = extract.requireAsyncCalls(code);\n\n      expect(ret).to.be.a('array');\n      expect(ret).to.have.length(3);\n      expect(ret).to.deep.equal(['foo', 'bar', 'baz']);\n    });\n  });\n});"]}