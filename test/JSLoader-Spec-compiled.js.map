{"version":3,"sources":["JSLoader-Spec.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA,SAAS,UAAT,EAAqB,YAAW;AAC5B,QAAI,YAAY,QAAQ,MAAR,CAAZ,CADwB;AAE5B,QAAI,KAAK,QAAQ,IAAR,CAAL,CAFwB;;AAI5B,QAAI,MAAM,QAAQ,OAAR,CAAN,CAJwB;AAK5B,QAAI,KAAK,QAAQ,eAAR,CAAL,CALwB;AAM5B,QAAI,WAAW,QAAQ,mBAAR,CAAX,CANwB;AAO5B,QAAI,uBAAuB,QAAQ,iCAAR,CAAvB,CAPwB;AAQ5B,QAAI,cAAc,QAAQ,oBAAR,CAAd,CARwB;;AAU5B,QAAI,SAAS,QAAQ,MAAR,EAAgB,MAAhB,CAVe;AAW5B,QAAI,WAAW,UAAU,IAAV,CAAe,SAAf,EAA0B,IAA1B,EAAgC,eAAhC,EAAiD,IAAjD,CAAX,CAXwB;;AAa5B,eAAW,YAAW;AAClB,YAAI,GAAG,UAAH,CAAc,QAAd,CAAJ,EAA6B;AACzB,eAAG,UAAH,CAAc,QAAd,EADyB;SAA7B;KADO,CAAX,CAb4B;;AAmB5B,UAAM,YAAW;AACb,YAAI,GAAG,UAAH,CAAc,QAAd,CAAJ,EAA6B;AACzB,eAAG,UAAH,CAAc,QAAd,EADyB;SAA7B;KADE,CAAN,CAnB4B;;AAyB5B,OAAG,oCAAH,EAAyC,YAAW;AAChD,YAAI,SAAS,IAAI,QAAJ,EAAT,CAD4C;AAEhD,eAAO,OAAO,SAAP,CAAiB,MAAjB,CAAP,EAAiC,EAAjC,CAAoC,EAApC,CAAuC,IAAvC,CAFgD;AAGhD,eAAO,OAAO,SAAP,CAAiB,QAAjB,CAAP,EAAmC,EAAnC,CAAsC,EAAtC,CAAyC,IAAzC,CAHgD;AAIhD,eAAO,OAAO,SAAP,CAAiB,SAAjB,CAAP,EAAoC,EAApC,CAAuC,EAAvC,CAA0C,KAA1C,CAJgD;KAAX,CAAzC,CAzB4B;;AAgC5B,OAAG,oCAAH,EAAyC,UAAS,IAAT,EAAe;AACpD,YAAI,SAAS,IAAI,QAAJ,EAAT,CADgD;AAEpD,eAAO,YAAP,CACI,UAAU,IAAV,CAAe,QAAf,EAAyB,WAAzB,CADJ,EAEI,IAFJ,EAGI,UAAS,CAAT,EAAY;AACR,mBAAO,EAAE,eAAF,CAAP,CAA0B,EAA1B,CAA6B,IAA7B,CAAkC,KAAlC,CAAwC,CACpC,cADoC,CAAxC,EADQ;;AAKR,mBALQ;SAAZ,CAHJ,CAFoD;KAAf,CAAzC,CAhC4B;;AA8C5B,OAAG,oCAAH,EAAyC,UAAS,IAAT,EAAe;AACpD,YAAI,SAAS,IAAI,QAAJ,EAAT,CADgD;AAEpD,eAAO,YAAP,CACI,UAAU,IAAV,CAAe,QAAf,EAAyB,uBAAzB,CADJ,EAEI,IAFJ,EAGI,UAAS,CAAT,EAAY;AACR,mBAAO,EAAE,QAAF,CAAP,CAAmB,EAAnB,CAAsB,EAAtB,CAAyB,KAAzB,CADQ;AAER,mBAAO,EAAE,EAAF,CAAP,CAAa,EAAb,CAAgB,KAAhB,CAAsB,wBAAtB,EAFQ;AAGR,mBAAO,EAAE,WAAF,CAAP,CAAsB,EAAtB,CAAyB,EAAzB,CAA4B,CAA5B,CAA8B,OAA9B,EAHQ;AAIR,mBAAO,EAAE,WAAF,CAAP,CAAsB,EAAtB,CAAyB,IAAzB,CAA8B,MAA9B,CAAqC,CAArC,EAJQ;AAKR,mBAAO,EAAE,WAAF,CAAP,CAAsB,EAAtB,CAAyB,IAAzB,CAA8B,KAA9B,CAAoC,CAAC,SAAD,CAApC,EALQ;;AAOR,mBAPQ;SAAZ,CAHJ,CAFoD;KAAf,CAAzC,CA9C4B;;AA8D5B,OAAG,oCAAH,EAAyC,UAAS,IAAT,EAAe;AACpD,YAAI,SAAS,IAAI,QAAJ,EAAT,CADgD;AAEpD,eAAO,YAAP,CACI,UAAU,IAAV,CAAe,QAAf,EAAyB,WAAzB,CADJ,EAEI,IAFJ,EAGI,UAAS,CAAT,EAAY;AACR,mBAAO,EAAE,QAAF,CAAP,CAAmB,EAAnB,CAAsB,EAAtB,CAAyB,IAAzB,CADQ;AAER,mBAAO,EAAE,EAAF,CAAP,CAAa,EAAb,CAAgB,KAAhB,CAAsB,YAAtB,EAFQ;AAGR,mBAAO,EAAE,eAAF,CAAP,CAA0B,EAA1B,CAA6B,EAA7B,CAAgC,CAAhC,CAAkC,OAAlC,EAHQ;AAIR,mBAAO,EAAE,eAAF,CAAP,CAA0B,EAA1B,CAA6B,IAA7B,CAAkC,MAAlC,CAAyC,CAAzC,EAJQ;AAKR,mBAAO,EAAE,eAAF,CAAP,CAA0B,EAA1B,CAA6B,IAA7B,CAAkC,KAAlC,CAAwC,CAAC,KAAD,EAAQ,KAAR,CAAxC,EALQ;AAMR,mBAAO,EAAE,WAAF,CAAP,CAAsB,EAAtB,CAAyB,EAAzB,CAA4B,CAA5B,CAA8B,OAA9B,EANQ;AAOR,mBAAO,EAAE,WAAF,CAAP,CAAsB,EAAtB,CAAyB,IAAzB,CAA8B,MAA9B,CAAqC,CAArC,EAPQ;AAQR,mBAAO,EAAE,WAAF,CAAP,CAAsB,EAAtB,CAAyB,IAAzB,CAA8B,KAA9B,CAAoC,CAAC,SAAD,CAApC,EARQ;;AAUR,mBAVQ;SAAZ,CAHJ,CAFoD;KAAf,CAAzC,CA9D4B;;AAiF5B,OAAG,0CAAH,EAA+C,UAAS,IAAT,EAAe;AAC1D,YAAI,SAAS,IAAI,QAAJ,EAAT,CADsD;AAE1D,eAAO,YAAP,CACI,UAAU,IAAV,CAAe,QAAf,EAAyB,YAAzB,EAAuC,MAAvC,CADJ,EAEI,IAAI,oBAAJ,CACI,UAAU,IAAV,CAAe,QAAf,EAAyB,YAAzB,EAAuC,cAAvC,CADJ,EAEI,EAFJ,CAFJ,EAKI,UAAS,CAAT,EAAY;AACR,mBAAO,EAAE,EAAF,CAAP,CAAa,EAAb,CAAgB,KAAhB,CAAsB,UAAU,IAAV,CAAe,YAAf,EAA4B,MAA5B,CAAtB,EADQ;AAER,mBAAO,EAAE,WAAF,CAAP,CAAsB,EAAtB,CAAyB,EAAzB,CAA4B,CAA5B,CAA8B,OAA9B,EAFQ;AAGR,mBAAO,EAAE,WAAF,CAAP,CAAsB,EAAtB,CAAyB,IAAzB,CAA8B,MAA9B,CAAqC,CAArC,EAHQ;AAIR,mBAAO,EAAE,WAAF,CAAP,CAAsB,EAAtB,CAAyB,IAAzB,CAA8B,KAA9B,CAAoC,CAAC,SAAD,CAApC,EAJQ;;AAMR,mBANQ;SAAZ,CALJ,CAF0D;KAAf,CAA/C,CAjF4B;;AAkG5B,OAAG,gDAAH,EAAqD,UAAS,IAAT,EAAe;AAChE,YAAI,SAAS,IAAI,QAAJ,EAAT,CAD4D;AAEhE,YAAI,MAAM,IAAI,WAAJ,CAAgB;;AAEtB,WAAG,UAAH,CAAc;AACV,gBAAI,eAAJ;AACA,kBAAM,kDAAN;AACA,6BAAiB,EAAjB;SAHJ,CAFsB,EAOtB,IAAI,oBAAJ,CAAyB,4BAAzB,CAPsB;;;AAUtB,WAAG,UAAH,CAAc;AACV,gBAAI,kBAAJ;AACA,kBAAM,2BAAN;AACA,6BAAiB,EAAjB;SAHJ,CAVsB,EAetB,IAAI,oBAAJ,CAAyB,+BAAzB,CAfsB,EAiBtB,GAAG,UAAH,CAAc;AACV,gBAAI,wCAAJ;AACA,kBAAM,wCAAN;AACA,6BAAiB,CAAC,eAAD,CAAjB;SAHJ,CAjBsB,EAsBtB,GAAG,UAAH,CAAc;AACV,gBAAI,2CAAJ;AACA,kBAAM,2CAAN;AACA,6BAAiB,CAAC,kBAAD,CAAjB;SAHJ,CAtBsB,EA2BtB,IAAI,oBAAJ,CAAyB,8BAAzB,CA3BsB,CAAhB,CAAN,CAF4D;;AAgChE,eAAO,WAAP,CAAmB,GAAnB,EAAwB,IAAI,qBAAJ,CAA0B,IAA1B,CAAxB,EAAyD,YAAW;AAChE,mBACI,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,wCAAtB,EAAgE,eAAhE,CADJ,CAEE,EAFF,CAEK,IAFL,CAEU,KAFV,CAEgB,CAAC,eAAD,CAFhB,EADgE;;AAKhE,mBACI,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,wCAAtB,EAAgE,2BAAhE,CADJ,CAEE,EAFF,CAEK,IAFL,CAEU,KAFV,CAEgB;AACR,iCAAiB,kDAAjB;aAHR,EALgE;;AAWhE,mBACI,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,2CAAtB,EAAmE,eAAnE,CADJ,CAEE,EAFF,CAEK,IAFL,CAEU,KAFV,CAEgB,CAAC,kBAAD,CAFhB,EAXgE;AAchE,mBACI,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,2CAAtB,EAAmE,2BAAnE,CADJ,CAEE,EAFF,CAEK,IAFL,CAEU,KAFV,CAEgB,EAAC,oBAAoB,2BAApB,EAFjB,EAdgE;;AAkBhE,mBAlBgE;SAAX,CAAzD,CAhCgE;KAAf,CAArD,CAlG4B;;AAwJ5B,OAAG,wDAAH,EAA6D,UAAS,IAAT,EAAe;AACxE,YAAI,SAAS,IAAI,QAAJ,EAAT,CADoE;AAExE,YAAI,MAAM,IAAI,WAAJ,CAAgB,CACtB,GAAG,UAAH,CAAc;AACV,gBAAI,iBAAJ;AACA,kBAAM,iBAAN;AACA,6BAAiB,CAAC,KAAD,CAAjB;SAHJ,CADsB,EAMtB,GAAG,UAAH,CAAc;AACV,gBAAI,iBAAJ;AACA,kBAAM,iBAAN;SAFJ,CANsB,EAUtB,IAAI,oBAAJ,CACI,UAAU,IAAV,CAAe,QAAf,EAAyB,YAAzB,EAAuC,cAAvC,CADJ,CAVsB,CAAhB,CAAN,CAFoE;;AAiBxE,eAAO,WAAP,CAAmB,GAAnB,EAAwB,IAAI,qBAAJ,CAA0B,IAA1B,CAAxB,EAAyD,YAAW;;AAEhE,oBAAQ,GAAR,CAAY,KAAK,SAAL,CAAe,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,iBAAtB,CAAf,CAAZ,EAFgE;;AAIhE,mBACI,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,iBAAtB,EAAyC,eAAzC,CADJ,CAEK,EAFL,CAEQ,IAFR,CAEa,KAFb,CAEmB,CAAC,iBAAD,CAFnB,EAJgE;AAQhE,mBACI,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,iBAAtB,EAAyC,2BAAzC,CADJ,CAEE,EAFF,CAEK,IAFL,CAEU,KAFV,CAEgB,EAAC,OAAO,iBAAP,EAFjB,EARgE;;AAYhE,mBAZgE;SAAX,CAAzD,CAjBwE;KAAf,CAA7D,CAxJ4B;;AAyL5B,OAAG,iDAAH,EAAsD,UAAS,IAAT,EAAe;AACjE,YAAI,WAAW,IAAI,QAAJ,EAAX,CAD6D;AAEjE,YAAI,MAAM,IAAI,WAAJ,CAAgB,CACtB,GAAG,UAAH,CAAc;AACV,gBAAI,iBAAJ;AACA,kBAAM,iBAAN;AACA,6BAAiB,CAAC,KAAD,CAAjB;SAHJ,CADsB,EAMtB,GAAG,UAAH,CAAc;AACV,gBAAI,iBAAJ;AACA,kBAAM,iBAAN;AACA,6BAAiB,EAAjB;SAHJ,CANsB,CAAhB,CAAN,CAF6D;AAcjE,iBAAS,WAAT,CAAqB,GAArB,EAA0B,IAAI,eAAJ,EAA1B,EAAiD,YAAW;AACxD,mBACI,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,iBAAtB,EAAyC,eAAzC,CADJ,CAEE,EAFF,CAEK,IAFL,CAEU,KAFV,CAEgB,CAAC,iBAAD,CAFhB,EADwD;;AAKxD,mBALwD;SAAX,CAAjD,CAdiE;KAAf,CAAtD,CAzL4B;;AAgN5B,OAAG,kDAAH,EAAuD,UAAS,IAAT,EAAe;AAClE,YAAI,MAAM,IAAI,GAAJ,CAAQ,CACd,IAAI,QAAJ,EADc,EAEd,IAAI,IAAI,OAAJ,CAAY,SAAZ,EAFU,CAAR,EAGP,CACC,sBADD,CAHO,EAKP;AACC,yBAAa,IAAb;SANM,CAAN,CAD8D;;AAUlE,YAAI,EAAJ,CAAO,eAAP,EAAwB,UAAS,GAAT,EAAc;AAClC,gBAAI,KAAK,sCAAL,CAD8B;AAElC,gBAAI,KAAK,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,EAAtB,CAAL,CAF8B;AAGlC,mBAAO,GAAG,WAAH,CAAP,CAAuB,EAAvB,CAA0B,EAA1B,CAA6B,CAA7B,CAA+B,OAA/B,EAHkC;AAIlC,mBAAO,GAAG,WAAH,CAAP,CAAuB,EAAvB,CAA0B,EAA1B,CAA6B,IAA7B,CAAkC,MAAlC,CAAyC,CAAzC,EAJkC;;AAMlC,mBANkC;SAAd,CAAxB,CAVkE;;AAmBlE,YAAI,MAAJ,CAAW,QAAX,EAAqB,YAAW,EAAX,CAArB,CAnBkE;KAAf,CAAvD,CAhN4B;;AAsO5B,OAAG,iDAAH,EAAsD,UAAS,IAAT,EAAe;AACjE,YAAI,MAAM,IAAI,GAAJ,CAAQ,CACd,IAAI,QAAJ,EADc,CAAR,EAEP,CACC,sBADD,CAFO,EAIP;AACC,yBAAa,IAAb;SALM,CAAN,CAD6D;;AASjE,YAAI,EAAJ,CAAO,eAAP,EAAwB,UAAS,GAAT,EAAc;AAClC,gBAAI,KAAK,qCAAL,CAD8B;AAElC,gBAAI,KAAK,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,EAAtB,CAAL,CAF8B;;AAIlC,mBAAO,GAAG,eAAH,CAAP,CAA2B,EAA3B,CAA8B,EAA9B,CAAiC,CAAjC,CAAmC,OAAnC,EAJkC;AAKlC,mBAAO,GAAG,eAAH,CAAP,CAA2B,EAA3B,CAA8B,EAA9B,CAAiC,IAAjC,CAAsC,MAAtC,CAA6C,CAA7C,EALkC;AAMlC,mBAAO,GAAG,eAAH,CAAP,CAA2B,EAA3B,CAA8B,IAA9B,CAAmC,KAAnC,CAAyC,CAAC,SAAD,CAAzC,EANkC;;AAQlC,mBARkC;SAAd,CAAxB,CATiE;;AAoBjE,YAAI,MAAJ,CAAW,QAAX,EAAqB,YAAW,EAAX,CAArB,CApBiE;KAAf,CAAtD,CAtO4B;;AA6P5B,OAAG,kDAAH,EAAuD,UAAS,IAAT,EAAe;AAClE,YAAI,MAAM,IAAI,GAAJ,CAAQ,CACd,IAAI,QAAJ,EADc,CAAR,EAEP,CACC,sBADD,CAFO,EAIP;AACC,yBAAa,IAAb;SALM,CAAN,CAD8D;;AASlE,YAAI,EAAJ,CAAO,eAAP,EAAwB,UAAS,GAAT,EAAc;AAClC,gBAAI,KAAK,sCAAL,CAD8B;AAElC,gBAAI,KAAK,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,EAAtB,CAAL,CAF8B;;AAIlC,mBAAO,GAAG,oBAAH,CAAP,CAAgC,EAAhC,CAAmC,EAAnC,CAAsC,CAAtC,CAAwC,OAAxC,EAJkC;AAKlC,mBAAO,GAAG,oBAAH,CAAP,CAAgC,EAAhC,CAAmC,EAAnC,CAAsC,IAAtC,CAA2C,MAA3C,CAAkD,CAAlD,EALkC;AAMlC,mBAAO,GAAG,oBAAH,CAAP,CAAgC,EAAhC,CAAmC,IAAnC,CAAwC,KAAxC,CAA8C,CAAC,SAAD,CAA9C,EANkC;;AAQlC,mBARkC;SAAd,CAAxB,CATkE;;AAoBlE,YAAI,MAAJ,CAAW,QAAX,EAAqB,YAAW,EAAX,CAArB,CApBkE;KAAf,CAAvD,CA7P4B;CAAX,CAArB","file":"JSLoader-Spec-compiled.js","sourcesContent":["/**\n * The MIT License (MIT)\n * Copyright (c) 2015 AceMood\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n * @file JS加载器功能测试\n * @author AceMood\n */\n\n/* globals describe */\n/* globals it */\n\ndescribe('JSLoader', function() {\n    var node_path = require('path');\n    var fs = require('fs');\n\n    var Neo = require('./neo');\n    var JS = require('./resource/JS');\n    var JSLoader = require('./loader/JSLoader');\n    var ProjectConfiguration = require('./resource/ProjectConfiguration');\n    var ResourceMap = require('./core/ResourceMap');\n\n    var expect = require('chai').expect;\n    var testData = node_path.join(__dirname, '..', '__test_data__', 'JS');\n\n    beforeEach(function() {\n        if (fs.existsSync('.cache')) {\n            fs.unlinkSync('.cache');\n        }\n    });\n\n    after(function() {\n        if (fs.existsSync('.cache')) {\n            fs.unlinkSync('.cache');\n        }\n    });\n\n    it('should match .js suffix file paths', function() {\n        var loader = new JSLoader();\n        expect(loader.matchPath('x.js')).to.be.true;\n        expect(loader.matchPath('a/x.js')).to.be.true;\n        expect(loader.matchPath('a/1.css')).to.be.false;\n    });\n\n    it('should parse old school components', function(done) {\n        var loader = new JSLoader();\n        loader.loadFromPath(\n            node_path.join(testData, 'Router.js'),\n            null,\n            function(r) {\n                expect(r.requiredModules).to.deep.equal([\n                    './iconconfig'\n                ]);\n\n                done();\n            });\n    });\n\n    it('should parse old school components', function(done) {\n        var loader = new JSLoader();\n        loader.loadFromPath(\n            node_path.join(testData, 'oldSchoolComponent.js'),\n            null,\n            function(r) {\n                expect(r.isModule).to.be.false;\n                expect(r.id).to.equal('oldSchoolComponent-tag');\n                expect(r.requiredCSS).to.be.a('array');\n                expect(r.requiredCSS).to.have.length(1);\n                expect(r.requiredCSS).to.deep.equal(['foo-css']);\n\n                done();\n            });\n    });\n\n    it('should parse modules with requires', function(done) {\n        var loader = new JSLoader();\n        loader.loadFromPath(\n            node_path.join(testData, 'module.js'),\n            null,\n            function(r) {\n                expect(r.isModule).to.be.true;\n                expect(r.id).to.equal('module-tag');\n                expect(r.requiredModules).to.be.a('array');\n                expect(r.requiredModules).to.have.length(2);\n                expect(r.requiredModules).to.deep.equal(['foo', 'bar']);\n                expect(r.requiredCSS).to.be.a('array');\n                expect(r.requiredCSS).to.have.length(1);\n                expect(r.requiredCSS).to.deep.equal(['foo-css']);\n\n                done();\n            });\n    });\n\n    it('should resolve paths using configuration', function(done) {\n        var loader = new JSLoader();\n        loader.loadFromPath(\n            node_path.join(testData, 'configured', 'a.js'),\n            new ProjectConfiguration(\n                node_path.join(testData, 'configured', 'package.json'),\n                {}),\n            function(r) {\n                expect(r.id).to.equal(node_path.join('configured','a.js'));\n                expect(r.requiredCSS).to.be.a('array');\n                expect(r.requiredCSS).to.have.length(1);\n                expect(r.requiredCSS).to.deep.equal(['foo-css']);\n\n                done();\n            });\n    });\n\n    it('should resolve CommonJS modules in postProcess', function(done) {\n        var loader = new JSLoader();\n        var map = new ResourceMap([\n            // hasCustomMain dependency project\n            JS.fromObject({\n                id: 'hasCustomMain',\n                path: 'hasCustomMain/folderWithMain/customMainModule.js',\n                requiredModules: []\n            }),\n            new ProjectConfiguration('hasCustomMain/package.json'),\n\n            // hasStandardIndex dependency project\n            JS.fromObject({\n                id: 'hasStandardIndex',\n                path: 'hasStandardIndex/index.js',\n                requiredModules: []\n            }),\n            new ProjectConfiguration('hasStandardIndex/package.json'),\n\n            JS.fromObject({\n                id: 'commonJSProject/dependsOnCustomMain.js',\n                path: 'commonJSProject/dependsOnCustomMain.js',\n                requiredModules: ['hasCustomMain']\n            }),\n            JS.fromObject({\n                id: 'commonJSProject/dependsOnStandardIndex.js',\n                path: 'commonJSProject/dependsOnStandardIndex.js',\n                requiredModules: ['hasStandardIndex']\n            }),\n            new ProjectConfiguration('commonJSProject/package.json')\n        ]);\n\n        loader.postProcess(map, map.getAllResourcesByType('js'), function() {\n            expect(\n                map.getResource('js', 'commonJSProject/dependsOnCustomMain.js').requiredModules\n            ).to.deep.equal(['hasCustomMain']);\n\n            expect(\n                map.getResource('js', 'commonJSProject/dependsOnCustomMain.js')._requiredTextToResolvedPath\n            ).to.deep.equal({\n                    'hasCustomMain': 'hasCustomMain/folderWithMain/customMainModule.js'\n                });\n\n            expect(\n                map.getResource('js', 'commonJSProject/dependsOnStandardIndex.js').requiredModules\n            ).to.deep.equal(['hasStandardIndex']);\n            expect(\n                map.getResource('js', 'commonJSProject/dependsOnStandardIndex.js')._requiredTextToResolvedPath\n            ).to.deep.equal({'hasStandardIndex': 'hasStandardIndex/index.js'});\n\n            done();\n        });\n    });\n\n    it('should resolve intern rel paths *with* package process', function(done) {\n        var loader = new JSLoader();\n        var map = new ResourceMap([\n            JS.fromObject({\n                id: 'configured/a.js',\n                path: 'configured/a.js',\n                requiredModules: ['./b']\n            }),\n            JS.fromObject({\n                id: 'configured/b.js',\n                path: 'configured/b.js'\n            }),\n            new ProjectConfiguration(\n                node_path.join(testData, 'configured', 'package.json')\n            )\n        ]);\n\n        loader.postProcess(map, map.getAllResourcesByType('js'), function() {\n\n            console.log(JSON.stringify(map.getResource('js', 'configured/a.js')));\n\n            expect(\n                map.getResource('js', 'configured/a.js').requiredModules)\n                .to.deep.equal(['configured/b.js']\n            );\n            expect(\n                map.getResource('js', 'configured/a.js')._requiredTextToResolvedPath\n            ).to.deep.equal({'./b': 'configured/b.js'});\n\n            done();\n        });\n    });\n\n    it('should resolve local paths without package.json', function(done) {\n        var jsLoader = new JSLoader();\n        var map = new ResourceMap([\n            JS.fromObject({\n                id: 'configured/a.js',\n                path: 'configured/a.js',\n                requiredModules: ['./b']\n            }),\n            JS.fromObject({\n                id: 'configured/b.js',\n                path: 'configured/b.js',\n                requiredModules: []\n            })\n        ]);\n        jsLoader.postProcess(map, map.getAllResources(), function() {\n            expect(\n                map.getResource('js', 'configured/a.js').requiredModules\n            ).to.deep.equal(['configured/b.js']);\n\n            done();\n        });\n    });\n\n    it('should resolve sync css module id in postProcess', function(done) {\n        var neo = new Neo([\n            new JSLoader(),\n            new Neo.Loaders.CSSLoader()\n        ], [\n            '__test_data__/Loader'\n        ], {\n            forceRescan: true\n        });\n\n        neo.on('postProcessed', function(map) {\n            var id = '__test_data__/Loader/sync-req-css.js';\n            var js = map.getResource('js', id);\n            expect(js.requiredCSS).to.be.a('array');\n            expect(js.requiredCSS).to.be.have.length(2);\n\n            done();\n        });\n\n        neo.update('.cache', function() {});\n    });\n\n    it('should resolve sync js module id in postProcess', function(done) {\n        var neo = new Neo([\n            new JSLoader()\n        ], [\n            '__test_data__/Loader'\n        ], {\n            forceRescan: true\n        });\n\n        neo.on('postProcessed', function(map) {\n            var id = '__test_data__/Loader/sync-req-js.js';\n            var js = map.getResource('js', id);\n\n            expect(js.requiredModules).to.be.a('array');\n            expect(js.requiredModules).to.be.have.length(1);\n            expect(js.requiredModules).to.deep.equal(['bo.base']);\n\n            done();\n        });\n\n        neo.update('.cache', function() {});\n    });\n\n    it('should resolve async js module id in postProcess', function(done) {\n        var neo = new Neo([\n            new JSLoader()\n        ], [\n            '__test_data__/Loader'\n        ], {\n            forceRescan: true\n        });\n\n        neo.on('postProcessed', function(map) {\n            var id = '__test_data__/Loader/async-req-js.js';\n            var js = map.getResource('js', id);\n\n            expect(js.requiredAsyncModules).to.be.a('array');\n            expect(js.requiredAsyncModules).to.be.have.length(1);\n            expect(js.requiredAsyncModules).to.deep.equal(['bo.base']);\n\n            done();\n        });\n\n        neo.update('.cache', function() {});\n    });\n\n});\n"]}