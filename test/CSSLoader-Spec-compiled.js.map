{"version":3,"sources":["CSSLoader-Spec.js"],"names":[],"mappings":"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","file":"CSSLoader-Spec-compiled.js","sourcesContent":["/**\n * The MIT License (MIT)\n * Copyright (c) 2015 AceMood\n *\n * @file CSSLoader功能测试\n * @author AceMood\n */\n\n/* globals describe */\n/* globals it */\n\ndescribe('CSSLoader', function() {\n\n  var expect = require('chai').expect;\n  var fs = require('fs');\n  var node_path = require('path');\n\n  var Neo = require('./neo');\n  var CSSLoader = require('./loader/CSSLoader');\n  var log = require('et-util-logger');\n  global.logger = new log.Logger();\n\n  var testData = node_path.join(__dirname, '..', '__test_data__', 'CSS');\n\n  beforeEach(function() {\n    if (fs.existsSync('.cache')) {\n      fs.unlinkSync('.cache');\n    }\n  });\n\n  after(function() {\n    if (fs.existsSync('.cache')) {\n      fs.unlinkSync('.cache');\n    }\n  });\n\n  it('should match css file paths', function() {\n    var loader = new CSSLoader();\n    expect(loader.matchPath('x.css')).to.be.true;\n    expect(loader.matchPath('a/x.css')).to.be.true;\n    expect(loader.matchPath('a/1.js')).to.be.false;\n  });\n\n  it('should extract component name', function(done) {\n    var loader = new CSSLoader();\n    loader.loadFromPath(\n        node_path.join(testData, 'plain.css'),\n        null,\n        function(r) {\n          expect(r.id).to.equal('plain-style');\n          expect(r.options).to.be.undefined;\n          expect(r.requiredCSS).to.be.a('array');\n          expect(r.requiredCSS).to.have.length(1);\n          expect(r.requiredCSS).to.deep.equal(['bar']);\n\n          done();\n        });\n  });\n\n  it('should parse special attributes', function(done) {\n    var loader = new CSSLoader();\n    loader.loadFromPath(\n        node_path.join(testData, 'special.css'),\n        null,\n        function(r) {\n          expect(r.id).to.equal('special-style');\n          expect(r.isNonblocking).to.be.true;\n          expect(r.isNopackage).to.be.true;\n\n          done();\n        });\n  });\n\n  it('should extract css sprites', function(done) {\n    var loader = new CSSLoader();\n    loader.loadFromPath(\n        node_path.join(testData, 'sprite.css'),\n        null,\n        function(r) {\n          expect(r.sprites).to.be.a('array');\n          expect(r.sprites).to.have.length(2);\n          expect(r.sprites).to.deep.equal([\n            'images/dialog/halo_top_left.png',\n            'images/dialog/large_halo_top_left.png'\n          ]);\n\n          done();\n        });\n  });\n\n  it('should resolve module id in postProcess', function(done) {\n    var neo = new Neo([\n      new CSSLoader()\n    ], [\n      __dirname + '/../__test_data__/Loader'\n    ], {\n      forceRescan: true\n    });\n\n    neo.on('postProcessed', function(map) {\n      var id = 'entry';\n      var css = map.getResource('css', id);\n\n      // todo _requiredTextToResolvedPath没有测试\n      expect(css.id).to.equal('entry');\n      expect(css.requiredCSS).to.be.a('array');\n      expect(css.requiredCSS).to.be.have.length(2);\n      expect(css.requiredCSS).to.deep.equal(['plain','dialog']);\n\n      done();\n    });\n\n    neo.update('.cache', function() {});\n  });\n});\n"]}